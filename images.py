import matplotlib.pyplot as plt
from mpl_toolkits.basemap import Basemap
from matplotlib.patches import Polygon
from osgeo import gdal,ogr,gdalconst

def images_foci(output_path, path_to_shapefile, foci, loc, num_of_years, start_Year, end_Year):

	vector_ds = ogr.Open(path_to_shapefile+".shp", gdalconst.GA_ReadOnly)
	vector_layer = vector_ds.GetLayer()
	extent = vector_layer.GetExtent()
	feature_count = vector_layer.GetFeatureCount()
	header = []
	
	for val in range(start_Year, end_Year+1):
		header.append(val)

	for i in range(num_of_years):
		foci_year = foci[i]
		points = []
		for vals in foci_year:
			points.append(loc[vals-1])
		get_image(output_path, path_to_shapefile, foci_year, points, extent, header[i])

def get_image(output_path, path_to_shapefile, foci_year, points, extent, year):

	map = Basemap(llcrnrlon=extent[0],llcrnrlat=extent[2],urcrnrlon=extent[1],urcrnrlat=extent[3],resolution='l')
	map.readshapefile(path_to_shapefile, 'shpfile')

	for i in range(len(foci_year)):
		map.plot(points[i][0], points[i][1], marker = '+', color = 'm', markersize = 6, markeredgewidth = 1)
	
	filename = output_path + "/Images/" + str(year) + ".png"
	plt.savefig(filename, dpi = 200, bbox_inches='tight')
	plt.clf()

def main():

	output_path = "/Users/anubhav/research/mistic"
	path_to_shapefile = "/Users/anubhav/research/mistic/shapefile/LGA"
	start_Year = 2001
	end_Year = 2010
	num_of_years = 10
	#foci = [[1, 2, 8, 21, 22, 23, 24, 35, 43, 44, 52, 53, 64, 95, 98, 100, 103, 106, 107, 111, 119, 122, 123, 148, 152]]
	#loc = [[146.9704166253, -36.0266032903], [151.9575589027, -30.5461094873]]
	foci = [[1, 2, 8, 21, 22, 23, 24, 35, 43, 44, 52, 53, 64, 95, 98, 100, 103, 106, 107, 111, 119, 122, 123, 148, 152], [1, 2, 8, 20, 22, 23, 24, 35, 40, 41, 43, 44, 59, 91, 95, 98, 100, 103, 106, 107, 111, 117, 119, 122, 148], [1, 2, 8, 20, 22, 23, 24, 35, 40, 41, 43, 44, 46, 53, 59, 68, 98, 100, 103, 105, 106, 107, 111, 119, 122, 125, 148], [1, 8, 20, 22, 23, 24, 27, 35, 40, 43, 44, 46, 54, 59, 64, 72, 91, 95, 98, 100, 103, 106, 111, 119, 122, 125, 141], [1, 8, 9, 20, 22, 23, 24, 27, 35, 40, 41, 43, 44, 48, 59, 72, 91, 95, 98, 100, 103, 111, 117, 119, 122, 141], [1, 2, 8, 20, 22, 23, 24, 27, 35, 39, 41, 43, 44, 46, 48, 91, 95, 98, 100, 103, 106, 111, 119, 122, 141], [1, 6, 8, 20, 22, 24, 27, 35, 43, 44, 46, 70, 72, 80, 91, 95, 100, 103, 105, 106, 111, 113, 119, 120, 122, 123, 125, 134, 141], [1, 2, 11, 20, 22, 23, 24, 27, 35, 43, 44, 46, 48, 56, 83, 91, 95, 100, 103, 106, 111, 113, 119, 122, 125, 134, 141], [1, 12, 20, 22, 23, 24, 27, 35, 41, 43, 44, 46, 48, 56, 59, 72, 91, 95, 98, 100, 103, 111, 113, 119, 122, 125, 141, 144], [1, 21, 22, 23, 24, 27, 35, 39, 41, 43, 56, 57, 59, 68, 72, 88, 91, 95, 99, 100, 103, 106, 111, 113, 117, 119, 122, 125, 134, 141, 143, 144, 150]]
	loc = [[146.9704166253, -36.0266032903], [151.9575589027, -30.5461094873], [151.1306943613, -33.8856917123], [151.0457490619, -33.8549516335], [153.4861796289, -28.8529078447], [143.6116784308, -33.9503423894], [151.013071147, -33.9234283683], [149.5255533894, -33.430078596], [149.7175683118, -36.8259553491], [152.7285814291, -30.4038019206], [145.7111935782, -35.7342975453], [150.8643091008, -33.7413343519], [146.9612182854, -33.8943540972], [149.1420416397, -33.5943428004], [150.4111415164, -33.6975446101], [146.866851493, -31.5381099443], [149.0403765688, -36.8835483086], [148.8513075825, -34.2936477899], [151.201595334, -33.9423155985], [145.3567057869, -29.9106084477], [146.9608402132, -29.7915740758], [141.4791685383, -31.9441842907], [151.1031476507, -33.8836868355], [153.4824616105, -28.6041829372], [148.7541274697, -33.1529809277], [150.7239319343, -34.0087566064], [150.8457978787, -34.0833917192], [151.1147552485, -33.8534973177], [151.0929009042, -33.9235893974], [145.4964431098, -33.6090322394], [143.5898231216, -31.8507973615], [151.2248481033, -32.925122859], [152.7511491261, -29.6817421391], [145.4830289636, -31.8680990396], [153.0398209371, -30.18905312], [144.941002938, -35.1666169206], [147.1048356485, -34.6325340624], [149.2246547595, -36.0695331851], [148.2916065479, -30.8705178206], [148.0140306099, -34.589879408], [146.2628638591, -35.8276572698], [148.7178865578, -33.7964204673], [144.9731791752, -35.5290892261], [148.6641650156, -32.2252054573], [151.6082820421, -32.3494827948], [149.9470493901, -35.9451565093], [150.8954070413, -33.8656364667], [147.8667399748, -33.421824385], [148.6906884588, -31.6190261458], [151.9030507429, -29.6450136654], [151.7951821155, -31.9058098181], [151.2162352263, -33.3714466858], [149.8134910055, -34.8760391875], [152.1535729239, -32.3560183618], [147.1718139458, -35.7502953476], [152.2812155912, -31.792070296], [146.0034742676, -34.3004084032], [148.143546261, -35.0152639172], [150.1888656648, -31.0465596659], [151.7048319639, -30.1333577203], [150.5168141154, -29.5932937367], [148.4063237673, -34.6128246364], [150.7731985001, -33.3348278427], [144.6837415393, -34.3158381817], [150.9574705119, -33.8283626786], [151.0891423574, -33.5868296562], [151.1451289725, -33.8333518425], [151.0714725231, -33.9645078936], [151.0677119241, -29.3599786024], [145.7880353914, -35.2188590056], [147.6688803399, -34.8172060061], [152.6447330817, -30.9515466067], [150.7562148268, -34.6789125046], [151.1080273844, -33.980566448], [151.150911143, -33.7346064046], [152.7755670483, -28.6178054333], [146.9899447302, -32.9200110644], [151.5301150384, -33.0387991371], [151.1668954039, -33.8199933465], [146.3021150045, -34.5323504641], [151.1678709261, -33.8704814547], [153.2706506943, -28.7561971084], [150.1789842927, -33.2776983233], [150.8253880892, -33.9359639905], [150.4384238913, -31.5506202936], [146.77542619, -35.331277976], [151.5497571289, -32.7108114925], [151.2699883364, -33.8002484566], [151.1588815609, -33.9078815545], [149.7424836527, -32.5937801857], [149.6289301328, -29.2528778678], [151.2446350912, -33.8290817171], [144.7420215472, -35.7323471496], [145.6725308156, -34.6892486711], [150.6302883304, -32.4399008476], [152.768938844, -30.6875561696], [149.5649112897, -30.3564783138], [146.5796903866, -34.611261941], [148.0655753292, -32.2261310856], [151.6956951808, -32.8800613361], [151.2118923033, -33.832941974], [149.8112988047, -33.8831202835], [149.1203857716, -33.3246547747], [149.6407195769, -35.4232208946], [147.9615292558, -32.8809298226], [151.0154109662, -33.8098134712], [150.7180521629, -33.7653824454], [151.2792873091, -33.6398197181], [152.5312443603, -31.4098113205], [151.8447239625, -32.7217905691], [149.2220153636, -35.4092733569], [151.2402058458, -33.9432406654], [153.0462853558, -29.0596313537], [151.1398722778, -33.9548642726], [151.110562338, -33.7991387784], [150.7738014803, -34.5827492826], [150.3713878167, -35.0941983928], [150.964580577, -32.6603829782], [148.6776613288, -36.3557936294], [151.076586368, -33.8803812663], [151.0510223603, -34.075139329], [151.2027415416, -33.8893771593], [150.9070393937, -30.8924960084], [147.4836563355, -34.3879395886], [152.0864390264, -28.9438606753], [150.964252, -33.59498923], [148.139841355, -36.0299343541], [148.3552419427, -35.4469884553], [153.3562204019, -28.3600089225], [150.7265913909, -31.9692282309], [149.4556779492, -34.4177300064], [151.3123217213, -30.5076741335], [146.2772847503, -35.2660087116], [147.3664681864, -35.1966613053], [143.9030132622, -35.0874318967], [151.784525606, -31.1639100633], [148.1944553995, -29.8166588483], [147.6798388608, -31.3256457256], [151.229761687, -33.7101569535], [149.4053840197, -31.462727016], [151.266729046, -33.8899822518], [148.0119750465, -33.8723329965], [149.0124237787, -32.5902146162], [142.2428434106, -33.5701944073], [151.1963701822, -33.8010961845], [150.356267645, -34.4769644238], [150.4437122687, -34.1019620879], [150.8370730513, -34.3688553442], [151.2573945427, -33.8716725885], [151.3733747264, -33.2269264375], [148.8848290567, -34.954167136], [148.2310626188, -34.2259532521], [142.2157917868, -30.654428922]]
	images_foci(output_path, path_to_shapefile, foci, loc, num_of_years, start_Year, end_Year)

if __name__ == '__main__':
	main()